@using GovUkDesignSystem
@using GovUkDesignSystem.GovUkDesignSystemComponents
@using Microsoft.AspNetCore.Mvc.TagHelpers
@using SeaPublicWebsite.BusinessLogic.Models.Enums

@model SeaPublicWebsite.Models.EnergyEfficiency.FloorInsulatedViewModel
@{
    ViewBag.Title = "Floor Insulated";
}

@section BeforeMain {
    @await Html.GovUkBackLink(new BackLinkViewModel
    {
        Text = "Back",
        Href = Model.BackLink,
        
        // Note: some of the "Back" links in this journey can't use the default browser behaviour
        //  so we should control all of them explicitly
        OverrideWithJavascript = false
    })
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        
        <form action="@Url.Action("FloorInsulated_Post", "EnergyEfficiency", new {reference = Model.Reference})" method="post" novalidate>
            @Html.AntiForgeryToken()
            @(Html.HiddenFor(m => m.EntryPoint))
            
            @{
                Func<object, object> details = 
                    @<text>
                        <p class="govuk-body">
                            A solid floor may be insulated by laying insulation on top or underneath a new floor.
                            If you’ve had to replace the ground floor, it’s likely insulated in order to comply with Building Regulations.
                        </p>
                        <p class="govuk-body">
                            A suspended timber floor can be insulated by lifting the floorboards and laying mineral wool
                            insulation supported by netting between the joists, or cutting rigid insulation boards to size.
                            It is possible done from below if there’s enough access to the cellar or crawl space.
                        </p>
                        <p class="govuk-body">
                            Suspended timber floors were rarely built with insulation, so this would need to have been installed after.
                        </p>
                     </text>;
                
                Func<object, object> epcHint = null;
                if (Model.Epc?.FloorInsulated is not null)
                {
                    epcHint = 
                        @<p>
                            Your @Model.Epc?.InspectionDate Energy Performance Certificate suggests you have
                            <strong>
                                @(Model.Epc?.FloorConstruction switch {
                                    FloorConstruction.SuspendedTimber => "suspended timber",
                                    FloorConstruction.SolidConcrete => "solid concrete",
                                    FloorConstruction.Mix => "mixed suspended timber and solid concrete",
                                    FloorConstruction.Other => "another type of",
                                    _ => throw new ArgumentOutOfRangeException()})
                            </strong>
                            floor.
                        </p>;
                }
            }
            
            @(await Html.GovUkRadiosFor(m => m.FloorInsulated,
                fieldsetOptions: new FieldsetViewModel
                {
                    Legend = new LegendViewModel
                    {
                        Html = @<text>
                                   <h1 class="govuk-fieldset__heading">
                                       Is your ground floor insulated?
                                   </h1>
                                </text>,
                        Classes = "govuk-fieldset__legend--l"
                    }
                },
                new HintViewModel
                {
                    Html = @<text>
                               <p class="govuk-body">
                                   Properties built before 1996 typically have uninsulated floors, unless you or a previous owner has installed floor insulation.
                               </p>
                               
                               @await Html.GovUkDetails(new DetailsViewModel
                               {
                                   SummaryText = "Help me answer this question",
                                   Html = details
                               })
                               
                               @if (epcHint is not null)
                               {
                                   @await Html.GovUkInsetText(new InsetTextViewModel
                                   {
                                       Classes = "sea-epc-hint",
                                       Html = epcHint
                                   })
                               }
                            </text>
                }))

            <button class="govuk-button" data-module="govuk-button">
                Continue
            </button>
            
        </form>
        
    </div>
</div>
